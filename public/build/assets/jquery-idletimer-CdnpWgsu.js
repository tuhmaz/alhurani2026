(function(n){n.idleTimer=function(i,l,o){var r;typeof i=="object"?(r=i,i=null):typeof i=="number"&&(r={timeout:i},i=null),l=l||document,o=o||"",r=n.extend({idle:!1,timeout:3e4,events:"mousemove keydown wheel DOMMouseScroll mousewheel mousedown touchstart touchmove MSPointerDown MSPointerMove"},r);var d=n(l),a=d.data("idleTimerObj"+o)||{},u=function(e){var t=n.data(l,"idleTimerObj"+o)||{};t.idle=!t.idle,t.olddate=+new Date;var f=n.Event((t.idle?"idle":"active")+".idleTimer"+o);n(l).trigger(f,[l,n.extend({},t),e])},m=function(e){var t=n.data(l,"idleTimerObj"+o)||{};if(!(e.type==="storage"&&e.originalEvent.key!==t.timerSyncId)&&t.remaining==null){if(e.type==="mousemove"){if(e.pageX===t.pageX&&e.pageY===t.pageY||typeof e.pageX>"u"&&typeof e.pageY>"u")return;var f=+new Date-t.olddate;if(f<200)return}clearTimeout(t.tId),t.idle&&u(e),t.lastActive=+new Date,t.pageX=e.pageX,t.pageY=e.pageY,e.type!=="storage"&&t.timerSyncId&&typeof localStorage<"u"&&localStorage.setItem(t.timerSyncId,t.lastActive),t.tId=setTimeout(u,t.timeout)}},c=function(){var e=n.data(l,"idleTimerObj"+o)||{};e.idle=e.idleBackup,e.olddate=+new Date,e.lastActive=e.olddate,e.remaining=null,clearTimeout(e.tId),e.idle||(e.tId=setTimeout(u,e.timeout))},g=function(){var e=n.data(l,"idleTimerObj"+o)||{};e.remaining==null&&(e.remaining=e.timeout-(+new Date-e.olddate),clearTimeout(e.tId))},s=function(){var e=n.data(l,"idleTimerObj"+o)||{};e.remaining!=null&&(e.idle||(e.tId=setTimeout(u,e.remaining)),e.remaining=null)},v=function(){var e=n.data(l,"idleTimerObj"+o)||{};clearTimeout(e.tId),d.removeData("idleTimerObj"+o),d.off("._idleTimer"+o)},p=function(){var e=n.data(l,"idleTimerObj"+o)||{};if(e.idle)return 0;if(e.remaining!=null)return e.remaining;var t=e.timeout-(+new Date-e.lastActive);return t<0&&(t=0),t};if(i===null&&typeof a.idle<"u")return c(),d;if(i!==null){if(i!==null&&typeof a.idle>"u")return!1;if(i==="destroy")return v(),d;if(i==="pause")return g(),d;if(i==="resume")return s(),d;if(i==="reset")return c(),d;if(i==="getRemainingTime")return p();if(i==="getElapsedTime")return+new Date-a.olddate;if(i==="getLastActiveTime")return a.lastActive;if(i==="isIdle")return a.idle}return d.on((r.events+" ").split(" ").join("._idleTimer"+o+" ").trim(),function(e){m(e)}),r.timerSyncId&&n(window).on("storage",m),a=n.extend({},{olddate:+new Date,lastActive:+new Date,idle:r.idle,idleBackup:r.idle,timeout:r.timeout,remaining:null,timerSyncId:r.timerSyncId,tId:null,pageX:null,pageY:null}),a.idle||(a.tId=setTimeout(u,a.timeout)),n.data(l,"idleTimerObj"+o,a),d},n.fn.idleTimer=function(i,l){return this[0]?n.idleTimer(i,this[0],l):this}})(jQuery);
