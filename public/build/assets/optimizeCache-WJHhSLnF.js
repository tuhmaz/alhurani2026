window.refreshData=function(){location.reload()};window.optimizeCache=function(){confirm("Are you sure you want to optimize the cache system?")&&fetch("/dashboard/redis/optimize",{method:"POST",headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content"),"Content-Type":"application/json"}}).then(e=>e.json()).then(e=>{e.success?(alert("Cache optimization completed successfully"),location.reload()):alert("Error occurred during optimization")}).catch(e=>{console.error("Error:",e),alert("Error occurred during optimization")})};window.loadReport=function(e){location.href=`/dashboard/redis/monitoring?hours=${e}`};window.analyzeKey=function(e){fetch("/dashboard/redis/analyze-key",{method:"POST",headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content"),"Content-Type":"application/json"},body:JSON.stringify({key:e})}).then(t=>t.json()).then(t=>{document.getElementById("key-analysis-content").innerHTML=`
            <h6>Key: <code>${e}</code></h6>
            <div class="row">
                <div class="col-md-6">
                    <p><strong>Operations:</strong> ${t.operations||0}</p>
                    <p><strong>Average Response Time:</strong> ${t.avg_response_time||0} ms</p>
                </div>
                <div class="col-md-6">
                    <p><strong>Memory Usage:</strong> ${t.memory_usage||0} KB</p>
                    <p><strong>TTL:</strong> ${t.ttl||0} seconds</p>
                </div>
            </div>
        `,new bootstrap.Modal(document.getElementById("keyAnalysisModal")).show()})};window.applyRecommendation=function(e){confirm("Are you sure you want to apply this optimization?")&&fetch("/dashboard/redis/apply-recommendation",{method:"POST",headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content"),"Content-Type":"application/json"},body:JSON.stringify({action:e})}).then(t=>t.json()).then(t=>{t.success?(alert("Optimization applied successfully"),location.reload()):alert("Error occurred during optimization")})};document.addEventListener("DOMContentLoaded",function(){const e=window.chartData?window.chartData.performance:[],t=window.chartData?window.chartData.hours:[],o={series:[{name:"Response Time",data:e}],chart:{type:"line",height:350},xaxis:{categories:t},yaxis:{title:{text:"Response Time (ms)"}}};document.getElementById("performanceChart")&&typeof ApexCharts<"u"&&new ApexCharts(document.querySelector("#performanceChart"),o).render();const n=window.chartData?window.chartData.memory_series:[],r=window.chartData?window.chartData.memory_labels:[],a={series:n,chart:{type:"donut",height:350},labels:r,responsive:[{breakpoint:480,options:{chart:{width:200},legend:{position:"bottom"}}}]};document.getElementById("memoryChart")&&typeof ApexCharts<"u"&&new ApexCharts(document.querySelector("#memoryChart"),a).render()});setInterval(function(){fetch("/dashboard/redis/stats").then(e=>e.json()).then(e=>{document.getElementById("memory-usage")&&(document.getElementById("memory-usage").textContent=e.memory_usage),document.getElementById("total-keys")&&(document.getElementById("total-keys").textContent=e.keys_count),document.getElementById("hit-ratio")&&(document.getElementById("hit-ratio").textContent=e.hit_ratio+"%"),document.getElementById("avg-ttl")&&(document.getElementById("avg-ttl").textContent=e.avg_ttl+"s")}).catch(e=>console.error("Error updating stats:",e))},3e4);
