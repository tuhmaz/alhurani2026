document.addEventListener("DOMContentLoaded",function(){const a=document.querySelector(".publish-btn"),l=document.querySelector(".unpublish-btn"),i=document.querySelector(".delete-form"),u=document.querySelectorAll(".attachment-download"),s=document.querySelector(".print-article"),r=document.querySelector(".share-article"),d=document.querySelectorAll(".keyword-badge");function c(t,n){t&&t.addEventListener("click",function(){const o=this.dataset.id,w=window.routes.articles[n].replace(":id",o);Swal.fire({title:window.translations[`${n}Confirmation`],text:window.translations[`${n}Message`],icon:"warning",showCancelButton:!0,confirmButtonText:window.translations.yes,cancelButtonText:window.translations.no,customClass:{confirmButton:`btn btn-${n==="publish"?"success":"warning"} me-3`,cancelButton:"btn btn-label-secondary"},buttonsStyling:!1}).then(f=>{f.isConfirmed&&fetch(w,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').content}}).then(e=>e.json()).then(e=>{e.success&&Swal.fire({icon:"success",title:window.translations.success,text:e.message,customClass:{confirmButton:"btn btn-success"},buttonsStyling:!1}).then(()=>{window.location.reload()})}).catch(e=>{console.error("Error:",e),Swal.fire({icon:"error",title:window.translations.error,text:window.translations.generalError,customClass:{confirmButton:"btn btn-danger"},buttonsStyling:!1})})})})}i&&i.addEventListener("submit",function(t){t.preventDefault();const n=this.dataset.confirm;Swal.fire({title:window.translations.deleteConfirmation,text:n,icon:"warning",showCancelButton:!0,confirmButtonText:window.translations.yes,cancelButtonText:window.translations.no,customClass:{confirmButton:"btn btn-danger me-3",cancelButton:"btn btn-label-secondary"},buttonsStyling:!1}).then(o=>{o.isConfirmed&&this.submit()})}),u.forEach(t=>{t.addEventListener("click",function(){const n=this.dataset.fileId,o=window.routes.files.download.replace(":id",n);fetch(o,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').content}})})}),s&&s.addEventListener("click",function(){window.print()}),r&&r.addEventListener("click",function(){navigator.share?navigator.share({title:document.title,url:window.location.href}).catch(console.error):navigator.clipboard.writeText(window.location.href).then(()=>{Swal.fire({icon:"success",title:window.translations.linkCopied,toast:!0,position:"top-end",showConfirmButton:!1,timer:3e3,customClass:{popup:"colored-toast"}})})}),d.forEach(t=>{t.addEventListener("click",function(){const n=this.textContent.trim();window.location.href=window.routes.articles.search+"?q="+encodeURIComponent(n)})}),document.querySelectorAll(".ql-content img").forEach(t=>{t.addEventListener("click",function(){Swal.fire({imageUrl:this.src,imageAlt:this.alt,showCloseButton:!0,showConfirmButton:!1,customClass:{popup:"image-popup"}})})}),c(a,"publish"),c(l,"unpublish")});
