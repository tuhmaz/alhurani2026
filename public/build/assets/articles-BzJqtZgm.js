$(function(){const s=$("#articlesTable").DataTable({processing:!0,serverSide:!1,ajax:{url:`/dashboard/articles/data?country=${country}`,data:function(a){return{...a,class_id:$("#class_id").val(),subject_id:$("#subject_id").val(),semester_id:$("#semester_id").val(),search:$("#searchArticle").val()}}},columns:[{data:"title"},{data:"subject"},{data:"semester"},{data:"class"},{data:"status"},{data:"created_at"},{data:null,orderable:!1}],columnDefs:[{targets:0,render:function(a,e,t){return t.image?'<div class="d-flex align-items-center"><img src="'+t.image+'" alt="'+t.title+'" class="rounded me-2" width="48"><div><h6 class="mb-0">'+t.title+"</h6></div></div>":t.title}},{targets:4,render:function(a,e,t){const c=parseInt(t.status);return'<span class="badge bg-'+(c===1?"success":"warning")+'">'+(c===1?"Published":"Draft")+"</span>"}},{targets:-1,render:function(a,e,t){return'<div class="d-flex gap-2"><a href="'+t.show_url+'" class="btn btn-sm btn-info"><i class="page-icon ti tabler-eye"></i></a><a href="'+t.edit_url+'" class="btn btn-sm btn-primary"><i class="page-icon ti tabler-pencil"></i></a><form action="'+t.delete_url+'" method="POST" class="delete-form d-inline"><input type="hidden" name="_token" value="'+$('meta[name="csrf-token"]').attr("content")+'"><input type="hidden" name="_method" value="DELETE"><button type="submit" class="btn btn-sm btn-danger"><i class="page-icon ti tabler-trash"></i></button></form></div>'}}],order:[[5,"desc"]],dom:'<"row"<"col-sm-12 col-md-6"l><"col-sm-12 col-md-6 d-flex justify-content-center justify-content-md-end"f>><"table-responsive"t><"row"<"col-sm-12 col-md-6"i><"col-sm-12 col-md-6"p>>',language:{search:"",searchPlaceholder:"Search Articles...",paginate:{previous:'<i class="page-icon ti tabler-chevron-left"></i>',next:'<i class="page-icon ti tabler-chevron-right"></i>'}},drawCallback:function(){i()}});$("#class_id, #subject_id, #semester_id").on("change",function(){s.ajax.reload()});let n;$("#searchArticle").on("keyup",function(){clearTimeout(n),n=setTimeout(()=>{s.ajax.reload()},500)}),$("#class_id").on("change",function(){const a=$(this).val();$("#subject_id option").each(function(){const e=$(this),t=e.data("class");!t||t===""||t===parseInt(a)?e.show():(e.hide(),e.is(":selected")&&$("#subject_id").val(""))}),$("#semester_id option").each(function(){const e=$(this),t=e.data("class");!t||t===""||t===parseInt(a)?e.show():(e.hide(),e.is(":selected")&&$("#semester_id").val(""))})});function i(){$(".delete-form").on("submit",function(a){a.preventDefault();const e=this;Swal.fire({title:"Are you sure?",text:"You won't be able to revert this!",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Yes, delete it!",customClass:{confirmButton:"btn btn-danger me-3",cancelButton:"btn btn-secondary"},buttonsStyling:!1}).then(t=>{t.isConfirmed&&e.submit()})})}i()});
