document.addEventListener("DOMContentLoaded",function(){let n=$(".datatables-trusted-ips");n.length&&(n.DataTable({dom:'<"row"<"col-sm-12 col-md-6"l><"col-sm-12 col-md-6 d-flex justify-content-center justify-content-md-end"f>>t<"row"<"col-sm-12 col-md-6"i><"col-sm-12 col-md-6"p>>',displayLength:10,lengthMenu:[10,25,50,75,100],responsive:!0,order:[[2,"desc"]],language:{search:window.translations.search,lengthMenu:window.translations.show_entries,info:window.translations.showing_entries,infoEmpty:window.translations.showing_zero,infoFiltered:window.translations.filtered,emptyTable:window.translations.no_trusted_ips,paginate:{first:window.translations.first,last:window.translations.last,next:window.translations.next,previous:window.translations.previous}}}),[].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]')).map(function(t){return new bootstrap.Tooltip(t)}))});function s(n){n.preventDefault();const o=n.target,t=new FormData(o);return fetch("/security/ip/trust",{method:"POST",headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content"),Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify(Object.fromEntries(t))}).then(e=>e.json()).then(e=>{if(e.status==="success")Swal.fire({title:window.translations.success,text:e.message,icon:"success",confirmButtonText:window.translations.ok}).then(()=>{bootstrap.Modal.getInstance(document.getElementById("trustIpModal")).hide(),window.location.reload()});else throw new Error(e.message||window.translations.error)}).catch(e=>{Swal.fire({title:window.translations.error,text:e.message,icon:"error",confirmButtonText:window.translations.ok})}),!1}function i(n){Swal.fire({title:window.translations.confirm_untrust,text:window.translations.untrust_confirmation,icon:"warning",showCancelButton:!0,confirmButtonText:window.translations.yes_untrust,cancelButtonText:window.translations.cancel,customClass:{confirmButton:"btn btn-primary me-3",cancelButton:"btn btn-label-secondary"},buttonsStyling:!1}).then(o=>{o.isConfirmed&&fetch(`/security/ip/${n}/untrust`,{method:"POST",headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content"),Accept:"application/json","Content-Type":"application/json"}}).then(t=>t.json()).then(t=>{if(t.status==="success")Swal.fire({title:window.translations.success,text:t.message,icon:"success",confirmButtonText:window.translations.ok,customClass:{confirmButton:"btn btn-success"},buttonsStyling:!1}).then(()=>{window.location.reload()});else throw new Error(t.message||window.translations.error)}).catch(t=>{Swal.fire({title:window.translations.error,text:t.message,icon:"error",confirmButtonText:window.translations.ok,customClass:{confirmButton:"btn btn-danger"},buttonsStyling:!1})})})}function r(n){fetch(`/security/ip/${n}/details`).then(o=>o.text()).then(o=>{document.getElementById("ipDetailsContent").innerHTML=o,new bootstrap.Modal(document.getElementById("ipDetailsModal")).show()}).catch(o=>{Swal.fire({title:window.translations.error,text:window.translations.failed_to_load,icon:"error",confirmButtonText:window.translations.ok,customClass:{confirmButton:"btn btn-danger"},buttonsStyling:!1})})}window.trustIp=s;window.untrustIp=i;window.viewIpDetails=r;
