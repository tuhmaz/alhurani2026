document.addEventListener("DOMContentLoaded",()=>{var y,f,b,g;const t={chatContactsBody:document.querySelector(".app-chat-contacts .sidebar-body"),chatHistoryBody:document.querySelector(".chat-history-body"),chatSidebarLeftBody:document.querySelector(".app-chat-sidebar-left .sidebar-body"),chatSidebarRightBody:document.querySelector(".app-chat-sidebar-right .sidebar-body"),chatUserStatus:[...document.querySelectorAll(".form-check-input[name='chat-user-status']")],chatSidebarLeftUserAbout:document.getElementById("chat-sidebar-left-user-about"),formSendMessage:document.querySelector(".form-send-message"),messageInput:document.querySelector(".message-input"),searchInput:document.querySelector(".chat-search-input"),chatContactListItems:[...document.querySelectorAll(".chat-contact-list-item:not(.chat-contact-list-item-title)")],textareaInfo:document.getElementById("textarea-maxlength-info"),conversationButton:document.getElementById("app-chat-conversation-btn"),chatHistoryHeader:document.querySelector(".chat-history-header [data-target='#app-chat-contacts']"),speechToText:$(".speech-to-text"),appChatConversation:document.getElementById("app-chat-conversation"),appChatHistory:document.getElementById("app-chat-history")},i={active:"avatar-online",offline:"avatar-offline",away:"avatar-away",busy:"avatar-busy"},n=e=>{e.forEach(a=>{a&&new PerfectScrollbar(a,{wheelPropagation:!1,suppressScrollX:!0})})},r=()=>{var e;return(e=t.chatHistoryBody)==null?void 0:e.scrollTo(0,t.chatHistoryBody.scrollHeight)},S=e=>{const a=document.querySelector(".chat-sidebar-left-user .avatar"),c=document.querySelector(".app-chat-contacts .avatar");[a,c].forEach(s=>{s&&(s.className=s.className.replace(/avatar-\w+/,i[e]))})};function u(e,a,c){const s=e.value.length,o=c-s;a.className="maxLength label-success",o>=0&&(a.textContent=`${s}/${c}`),o<=0&&(a.textContent=`${s}/${c}`,a.classList.remove("label-success"),a.classList.add("label-danger"))}const h=()=>{t.appChatConversation.classList.replace("d-flex","d-none"),t.appChatHistory.classList.replace("d-none","d-block")},m=(e,a,c)=>{var v;const s=document.querySelectorAll(`${e}:not(.chat-contact-list-item-title)`);let o=0;s.forEach(l=>{const d=l.textContent.toLowerCase().includes(a);l.classList.toggle("d-flex",d),l.classList.toggle("d-none",!d),d&&o++}),(v=document.querySelector(c))==null||v.classList.toggle("d-none",o>0)},L=()=>{const e=window.SpeechRecognition||window.webkitSpeechRecognition;if(!e||t.speechToText.length===0)return;const a=new e;let c=!1;t.speechToText.on("click",function(){c||a.start(),a.onspeechstart=()=>c=!0,a.onresult=s=>{$(this).closest(".form-send-message").find(".message-input").val(s.results[0][0].transcript)},a.onspeechend=()=>c=!1,a.onerror=()=>c=!1})};n([t.chatContactsBody,t.chatHistoryBody,t.chatSidebarLeftBody,t.chatSidebarRightBody]),r(),t.chatUserStatus.forEach(e=>{e.addEventListener("click",()=>S(e.value))});const p=parseInt(t.chatSidebarLeftUserAbout.getAttribute("maxlength"),10);u(t.chatSidebarLeftUserAbout,t.textareaInfo,p),t.chatSidebarLeftUserAbout.addEventListener("input",()=>{u(t.chatSidebarLeftUserAbout,t.textareaInfo,p)}),(y=t.conversationButton)==null||y.addEventListener("click",h),t.chatContactListItems.forEach(e=>{e.addEventListener("click",()=>{t.chatContactListItems.forEach(a=>a.classList.remove("active")),e.classList.add("active"),h()})}),(f=t.searchInput)==null||f.addEventListener("keyup",C(e=>{const a=e.target.value.toLowerCase();m("#chat-list li",a,".chat-list-item-0"),m("#contact-list li",a,".contact-list-item-0")},300)),(b=t.formSendMessage)==null||b.addEventListener("submit",e=>{var c;e.preventDefault();const a=t.messageInput.value.trim();if(a){const s=document.createElement("div");s.className="chat-message-text mt-2",s.innerHTML=`<p class="mb-0 text-break">${a}</p>`,(c=document.querySelector("li:last-child .chat-message-wrapper"))==null||c.appendChild(s),t.messageInput.value="",r()}}),(g=t.chatHistoryHeader)==null||g.addEventListener("click",()=>{var e;(e=document.querySelector(".app-chat-sidebar-left .close-sidebar"))==null||e.removeAttribute("data-overlay")}),L()});function C(t,i){let n;return(...r)=>{clearTimeout(n),n=setTimeout(()=>t.apply(this,r),i)}}
